# 
___
___
## ╭─────────────────── Traceback (most recent call last) ───────────────────╮│ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ px\_transports\default.py:69 in map_httpcore_exceptions                 ││                                                                         ││    66 @contextlib.contextmanager                                        ││    67 def map_httpcore_exceptions() -> typing.Iterator[None]:           ││    68 │   try:                                                          ││ ❱  69 │   │   yield                                                     ││    70 │   except Exception as exc:                                      ││    71 │   │   mapped_exc = None                                         ││    72                                                                   ││                                                                         ││ ╭────────────────────── locals ───────────────────────╮                 ││ │   from_exc = <class 'httpcore.RemoteProtocolError'> │                 ││ │ mapped_exc = <class 'httpx.ConnectError'>           │                 ││ │    message = 'All connection attempts failed'       │                 ││ │     to_exc = <class 'httpx.RemoteProtocolError'>    │                 ││ ╰─────────────────────────────────────────────────────╯                 ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ px\_transports\default.py:373 in handle_async_request                   ││                                                                         ││   370 │   │   │   extensions=request.extensions,                        ││   371 │   │   )                                                         ││   372 │   │   with map_httpcore_exceptions():                           ││ ❱ 373 │   │   │   resp = await self._pool.handle_async_request(req)     ││   374 │   │                                                             ││   375 │   │   assert isinstance(resp.stream, typing.AsyncIterable)      ││   376                                                                   ││                                                                         ││ ╭───────────────────────────── locals ──────────────────────────────╮   ││ │     req = <Request [b'POST']>                                     │   ││ │ request = <Request('POST', 'http://localhost:8765')>              │   ││ │    self = <httpx.AsyncHTTPTransport object at 0x0000024E868C4BC0> │   ││ ╰───────────────────────────────────────────────────────────────────╯   ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ pcore\_async\connection_pool.py:216 in handle_async_request             ││                                                                         ││   213 │   │   │   │   closing = self._assign_requests_to_connections()  ││   214 │   │   │                                                         ││   215 │   │   │   await self._close_connections(closing)                ││ ❱ 216 │   │   │   raise exc from None                                   ││   217 │   │                                                             ││   218 │   │   # Return the response. Note that in this case we still ha ││   219 │   │   # the point at which the response is closed.              ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │      closing = []                                                   │ ││ │   connection = <AsyncHTTPConnection [CONNECTION FAILED]>            │ ││ │ pool_request = <httpcore._async.connection_pool.AsyncPoolRequest    │ ││ │                object at 0x0000024E868C74A0>                        │ ││ │      request = <Request [b'POST']>                                  │ ││ │       scheme = 'http'                                               │ ││ │         self = <AsyncConnectionPool [Requests: 0 active, 0 queued | │ ││ │                Connections: 0 active, 0 idle]>                      │ ││ │      timeout = 5.0                                                  │ ││ │     timeouts = {                                                    │ ││ │                │   'connect': 5.0,                                  │ ││ │                │   'read': 5.0,                                     │ ││ │                │   'write': 5.0,                                    │ ││ │                │   'pool': 5.0                                      │ ││ │                }                                                    │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ pcore\_async\connection_pool.py:196 in handle_async_request             ││                                                                         ││   193 │   │   │   │                                                     ││   194 │   │   │   │   try:                                              ││   195 │   │   │   │   │   # Send the request on the assigned connection ││ ❱ 196 │   │   │   │   │   response = await connection.handle_async_requ ││   197 │   │   │   │   │   │   pool_request.request                      ││   198 │   │   │   │   │   )                                             ││   199 │   │   │   │   except ConnectionNotAvailable:                    ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │      closing = []                                                   │ ││ │   connection = <AsyncHTTPConnection [CONNECTION FAILED]>            │ ││ │ pool_request = <httpcore._async.connection_pool.AsyncPoolRequest    │ ││ │                object at 0x0000024E868C74A0>                        │ ││ │      request = <Request [b'POST']>                                  │ ││ │       scheme = 'http'                                               │ ││ │         self = <AsyncConnectionPool [Requests: 0 active, 0 queued | │ ││ │                Connections: 0 active, 0 idle]>                      │ ││ │      timeout = 5.0                                                  │ ││ │     timeouts = {                                                    │ ││ │                │   'connect': 5.0,                                  │ ││ │                │   'read': 5.0,                                     │ ││ │                │   'write': 5.0,                                    │ ││ │                │   'pool': 5.0                                      │ ││ │                }                                                    │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ pcore\_async\connection.py:99 in handle_async_request                   ││                                                                         ││    96 │   │   │   │   │   │   )                                         ││    97 │   │   except BaseException as exc:                              ││    98 │   │   │   self._connect_failed = True                           ││ ❱  99 │   │   │   raise exc                                             ││   100 │   │                                                             ││   101 │   │   return await self._connection.handle_async_request(reques ││   102                                                                   ││                                                                         ││ ╭────────────────────── locals ───────────────────────╮                 ││ │ request = <Request [b'POST']>                       │                 ││ │    self = <AsyncHTTPConnection [CONNECTION FAILED]> │                 ││ ╰─────────────────────────────────────────────────────╯                 ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ pcore\_async\connection.py:76 in handle_async_request                   ││                                                                         ││    73 │   │   try:                                                      ││    74 │   │   │   async with self._request_lock:                        ││    75 │   │   │   │   if self._connection is None:                      ││ ❱  76 │   │   │   │   │   stream = await self._connect(request)         ││    77 │   │   │   │   │                                                 ││    78 │   │   │   │   │   ssl_object = stream.get_extra_info("ssl_objec ││    79 │   │   │   │   │   http2_negotiated = (                          ││                                                                         ││ ╭────────────────────── locals ───────────────────────╮                 ││ │ request = <Request [b'POST']>                       │                 ││ │    self = <AsyncHTTPConnection [CONNECTION FAILED]> │                 ││ ╰─────────────────────────────────────────────────────╯                 ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ pcore\_async\connection.py:122 in _connect                              ││                                                                         ││   119 │   │   │   │   │   │   "socket_options": self._socket_options,   ││   120 │   │   │   │   │   }                                             ││   121 │   │   │   │   │   async with Trace("connect_tcp", logger, reque ││ ❱ 122 │   │   │   │   │   │   stream = await self._network_backend.conn ││   123 │   │   │   │   │   │   trace.return_value = stream               ││   124 │   │   │   │   else:                                             ││   125 │   │   │   │   │   kwargs = {                                    ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │       delays = <generator object exponential_backoff at             │ ││ │                0x0000024E86697E00>                                  │ ││ │       kwargs = {                                                    │ ││ │                │   'host': 'localhost',                             │ ││ │                │   'port': 8765,                                    │ ││ │                │   'local_address': None,                           │ ││ │                │   'timeout': 5.0,                                  │ ││ │                │   'socket_options': None                           │ ││ │                }                                                    │ ││ │      request = <Request [b'POST']>                                  │ ││ │ retries_left = 0                                                    │ ││ │         self = <AsyncHTTPConnection [CONNECTION FAILED]>            │ ││ │ sni_hostname = None                                                 │ ││ │      timeout = 5.0                                                  │ ││ │     timeouts = {                                                    │ ││ │                │   'connect': 5.0,                                  │ ││ │                │   'read': 5.0,                                     │ ││ │                │   'write': 5.0,                                    │ ││ │                │   'pool': 5.0                                      │ ││ │                }                                                    │ ││ │        trace = <httpcore._trace.Trace object at 0x0000024E868C7A40> │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ pcore\_backends\auto.py:30 in connect_tcp                               ││                                                                         ││   27 │   │   socket_options: typing.Optional[typing.Iterable[SOCKET_OPT ││   28 │   ) -> AsyncNetworkStream:                                       ││   29 │   │   await self._init_backend()                                 ││ ❱ 30 │   │   return await self._backend.connect_tcp(                    ││   31 │   │   │   host,                                                  ││   32 │   │   │   port,                                                  ││   33 │   │   │   timeout=timeout,                                       ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │           host = 'localhost'                                        │ ││ │  local_address = None                                               │ ││ │           port = 8765                                               │ ││ │           self = <httpcore._backends.auto.AutoBackend object at     │ ││ │                  0x0000024E868C5910>                                │ ││ │ socket_options = None                                               │ ││ │        timeout = 5.0                                                │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ pcore\_backends\anyio.py:114 in connect_tcp                             ││                                                                         ││   111 │   │   │   OSError: ConnectError,                                ││   112 │   │   │   anyio.BrokenResourceError: ConnectError,              ││   113 │   │   }                                                         ││ ❱ 114 │   │   with map_exceptions(exc_map):                             ││   115 │   │   │   with anyio.fail_after(timeout):                       ││   116 │   │   │   │   stream: anyio.abc.ByteStream = await anyio.connec ││   117 │   │   │   │   │   remote_host=host,                             ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │        exc_map = {                                                  │ ││ │                  │   <class 'TimeoutError'>: <class                 │ ││ │                  'httpcore.ConnectTimeout'>,                        │ ││ │                  │   <class 'OSError'>: <class                      │ ││ │                  'httpcore.ConnectError'>,                          │ ││ │                  │   <class 'anyio.BrokenResourceError'>: <class    │ ││ │                  'httpcore.ConnectError'>                           │ ││ │                  }                                                  │ ││ │           host = 'localhost'                                        │ ││ │  local_address = None                                               │ ││ │           port = 8765                                               │ ││ │           self = <httpcore.AnyIOBackend object at                   │ ││ │                  0x0000024E868C5070>                                │ ││ │ socket_options = []                                                 │ ││ │        timeout = 5.0                                                │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Program                                                              ││ Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.1264.0_x64_ ││ _qbz5n2kfra8p0\Lib\contextlib.py:158 in __exit__                        ││                                                                         ││   155 │   │   │   │   # tell if we get the same exception back          ││   156 │   │   │   │   value = typ()                                     ││   157 │   │   │   try:                                                  ││ ❱ 158 │   │   │   │   self.gen.throw(value)                             ││   159 │   │   │   except StopIteration as exc:                          ││   160 │   │   │   │   # Suppress StopIteration *unless* it's the same e ││   161 │   │   │   │   # was passed to throw().  This prevents a StopIte ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │      self = <contextlib._GeneratorContextManager object at          │ ││ │             0x0000024E868C4320>                                     │ ││ │ traceback = <traceback object at 0x0000024E85B77800>                │ ││ │       typ = <class 'OSError'>                                       │ ││ │     value = OSError('All connection attempts failed')               │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ pcore\_exceptions.py:14 in map_exceptions                               ││                                                                         ││   11 │   except Exception as exc:  # noqa: PIE786                       ││   12 │   │   for from_exc, to_exc in map.items():                       ││   13 │   │   │   if isinstance(exc, from_exc):                          ││ ❱ 14 │   │   │   │   raise to_exc(exc) from exc                         ││   15 │   │   raise  # pragma: nocover                                   ││   16                                                                    ││   17                                                                    ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │ from_exc = <class 'OSError'>                                        │ ││ │      map = {                                                        │ ││ │            │   <class 'TimeoutError'>: <class                       │ ││ │            'httpcore.ConnectTimeout'>,                              │ ││ │            │   <class 'OSError'>: <class 'httpcore.ConnectError'>,  │ ││ │            │   <class 'anyio.BrokenResourceError'>: <class          │ ││ │            'httpcore.ConnectError'>                                 │ ││ │            }                                                        │ ││ │   to_exc = <class 'httpcore.ConnectError'>                          │ ││ ╰─────────────────────────────────────────────────────────────────────╯ │╰─────────────────────────────────────────────────────────────────────────╯ConnectError: All connection attempts failed

The above exception was the direct cause of the following exception:       

╭─────────────────── Traceback (most recent call last) ───────────────────╮│ c:\pythonLearn\widgets.py:728 in on_button_pressed                      ││                                                                         ││   725 │   │   │   app.messages.pop()                                    ││   726 │   │   │   app.messages[0]=message0                              ││   727 │   │   │   #keyboard.send("ctrl+space")                          ││ ❱ 728 │   │   if event.button.id=="saved":#保存按钮                     ││   729 │   │   │   self.install_screen(Screen_saved(),name="screen_saved ││   730 │   │   │   self.push_screen("screen_saved"+str(self.saveloop))   ││   731 │   │   │   self.saveloop+=1                                      ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │  answers = '\n\n####                                                │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │     char = ['']                                                     │ ││ │    event = Pressed()                                                │ ││ │   Github = [                                                        │ ││ │            │                                                        │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   '6a75792e1d170b6849bd3dc373bcf2fbf54863d0'           │ ││ │            ]                                                        │ ││ │  history = '# \n___\n___\n##  if event.button.id == "github":\r\n   │ ││ │            result=await OpenGit'+909                                │ ││ │     list = [                                                        │ ││ │            │   [                                                    │ ││ │            │   │   'if event.button.id == "github":',               │ ││ │            │   │   '检查事件按钮的ID是否为"github"。',              │ ││ │            │   │                                                    │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   │   '\n\n####                                        │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │   │                                                    │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   ],                                                   │ ││ │            │   [                                                    │ ││ │            │   │   'result=await OpenGithub(self.history_note)',    │ ││ │            │   │                                                    │ ││ │            '异步调用OpenGithub函数，并将结果赋值给result变量。',    │ ││ │            │   │                                                    │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   │   '\n\n####                                        │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │   │                                                    │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   ],                                                   │ ││ │            │   [                                                    │ ││ │            │   │   'webbrowser.open(result[0])',                    │ ││ │            │   │                                                    │ ││ │            '使用webbrowser模块打开result列表中的第一个URL。',       │ ││ │            │   │                                                    │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   │   '\n\n####                                        │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │   │                                                    │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   ]                                                    │ ││ │            ]                                                        │ ││ │ message0 = {                                                        │ ││ │            │   'role': 'system',                                    │ ││ │            │   'content':                                           │ ││ │            '这个GPT的目的是根据用户上传的图像或文字字段，生成相关 … │ ││ │            }                                                        │ ││ │     note = '
### if event.button.id ==                                  │ ││ │            "github":
- 检查事件按钮的ID是否为"github"。
### \n\n
### result… │ ││ │            OpenGith'+122                                            │ ││ │ note_md5 = '4500d650d34ef9aed4691b5eb6e45cc1'                       │ ││ │ res_task = <Task finished name='Task-4695' coro=<add_note() done,   │ ││ │            defined at c:\pythonLearn\tools.py:249>                  │ ││ │            exception=ConnectError('All connection attempts          │ ││ │            failed')>                                                │ ││ │     self = MyApp(title='MyApp', classes={'-dark-mode'})             │ ││ │   source = '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │     task = <Task finished name='Task-4659' coro=<gpt_get() done,    │ ││ │            defined at c:\pythonLearn\tools.py:160> result='
### if      │ ││ │            event.bu...t列表中的第一个URL。
### '>                       │ ││ │        x = '6'                                                      │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ c:\pythonLearn\tools.py:296 in add_note                                 ││                                                                         ││   293 │   }                                                             ││   294 }                                                                 ││   295 │   async with httpx.AsyncClient() as client:                     ││ ❱ 296 │   │   response = await client.post(url, headers=headers, data=j ││   297 │   │   return response.json()                                    ││   298                                                                   ││   299 async def anki_sync():                                            ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │   client = <httpx.AsyncClient object at 0x0000024E86B67B00>         │ ││ │ datetime = <class 'datetime.datetime'>                              │ ││ │  headers = {'Content-Type': 'application/json'}                     │ ││ │        i = [                                                        │ ││ │            │   'webbrowser.open(result[0])',                        │ ││ │            │   '使用webbrowser模块打开result列表中的第一个URL。',   │ ││ │            │                                                        │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   '\n\n####                                            │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │                                                        │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            ]                                                        │ ││ │     json = <module 'json' from 'C:\\Program                         │ ││ │            Files\\WindowsApps\\PythonSoftwareFoundation.Python.3.1… │ ││ │     list = [                                                        │ ││ │            │   [                                                    │ ││ │            │   │   'if event.button.id == "github":',               │ ││ │            │   │   '检查事件按钮的ID是否为"github"。',              │ ││ │            │   │                                                    │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   │   '\n\n####                                        │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │   │                                                    │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   ],                                                   │ ││ │            │   [                                                    │ ││ │            │   │   'result=await OpenGithub(self.history_note)',    │ ││ │            │   │                                                    │ ││ │            '异步调用OpenGithub函数，并将结果赋值给result变量。',    │ ││ │            │   │                                                    │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   │   '\n\n####                                        │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │   │                                                    │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   ],                                                   │ ││ │            │   [                                                    │ ││ │            │   │   'webbrowser.open(result[0])',                    │ ││ │            │   │                                                    │ ││ │            '使用webbrowser模块打开result列表中的第一个URL。',       │ ││ │            │   │                                                    │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   │   '\n\n####                                        │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │   │                                                    │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   ]                                                    │ ││ │            ]                                                        │ ││ │     name = 'gpt'                                                    │ ││ │    notes = [                                                        │ ││ │            │   {                                                    │ ││ │            │   │   'deckName': 'gpt',                               │ ││ │            │   │   'modelName': 'markdown',                         │ ││ │            │   │   'fields': {                                      │ ││ │            │   │   │   'Front': 'if event.button.id == "github":',  │ ││ │            │   │   │   'Back': '检查事件按钮的ID是否为"github"。',  │ ││ │            │   │   │   'Answer':                                    │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   │   │   'Source': '\n\n####                          │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │   │   │   'Github':                                    │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   │   },                                               │ ││ │            │   │   'options': {                                     │ ││ │            │   │   │   'allowDuplicate': False,                     │ ││ │            │   │   │   'duplicateScope': 'deck',                    │ ││ │            │   │   │   'duplicateScopeOptions': {                   │ ││ │            │   │   │   │   'deckName': 'Default',                   │ ││ │            │   │   │   │   'checkChildren': False,                  │ ││ │            │   │   │   │   'checkAllModels': False                  │ ││ │            │   │   │   }                                            │ ││ │            │   │   },                                               │ ││ │            │   │   'tags': ['2024年', '08月', '03日']               │ ││ │            │   },                                                   │ ││ │            │   {                                                    │ ││ │            │   │   'deckName': 'gpt',                               │ ││ │            │   │   'modelName': 'markdown',                         │ ││ │            │   │   'fields': {                                      │ ││ │            │   │   │   'Front': 'result=await                       │ ││ │            OpenGithub(self.history_note)',                          │ ││ │            │   │   │   'Back':                                      │ ││ │            '异步调用OpenGithub函数，并将结果赋值给result变量。',    │ ││ │            │   │   │   'Answer':                                    │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   │   │   'Source': '\n\n####                          │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │   │   │   'Github':                                    │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   │   },                                               │ ││ │            │   │   'options': {                                     │ ││ │            │   │   │   'allowDuplicate': False,                     │ ││ │            │   │   │   'duplicateScope': 'deck',                    │ ││ │            │   │   │   'duplicateScopeOptions': {                   │ ││ │            │   │   │   │   'deckName': 'Default',                   │ ││ │            │   │   │   │   'checkChildren': False,                  │ ││ │            │   │   │   │   'checkAllModels': False                  │ ││ │            │   │   │   }                                            │ ││ │            │   │   },                                               │ ││ │            │   │   'tags': ['2024年', '08月', '03日']               │ ││ │            │   },                                                   │ ││ │            │   {                                                    │ ││ │            │   │   'deckName': 'gpt',                               │ ││ │            │   │   'modelName': 'markdown',                         │ ││ │            │   │   'fields': {                                      │ ││ │            │   │   │   'Front': 'webbrowser.open(result[0])',       │ ││ │            │   │   │   'Back':                                      │ ││ │            '使用webbrowser模块打开result列表中的第一个URL。',       │ ││ │            │   │   │   'Answer':                                    │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   │   │   'Source': '\n\n####                          │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │   │   │   'Github':                                    │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   │   },                                               │ ││ │            │   │   'options': {                                     │ ││ │            │   │   │   'allowDuplicate': False,                     │ ││ │            │   │   │   'duplicateScope': 'deck',                    │ ││ │            │   │   │   'duplicateScopeOptions': {                   │ ││ │            │   │   │   │   'deckName': 'Default',                   │ ││ │            │   │   │   │   'checkChildren': False,                  │ ││ │            │   │   │   │   'checkAllModels': False                  │ ││ │            │   │   │   }                                            │ ││ │            │   │   },                                               │ ││ │            │   │   'tags': ['2024年', '08月', '03日']               │ ││ │            │   }                                                    │ ││ │            ]                                                        │ ││ │  payload = {                                                        │ ││ │            │   'action': 'addNotes',                                │ ││ │            │   'version': 6,                                        │ ││ │            │   'params': {                                          │ ││ │            │   │   'notes': [                                       │ ││ │            │   │   │   {                                            │ ││ │            │   │   │   │   'deckName': 'gpt',                       │ ││ │            │   │   │   │   'modelName': 'markdown',                 │ ││ │            │   │   │   │   'fields': {                              │ ││ │            │   │   │   │   │   'Front': 'if event.button.id ==      │ ││ │            "github":',                                              │ ││ │            │   │   │   │   │   'Back':                              │ ││ │            '检查事件按钮的ID是否为"github"。',                      │ ││ │            │   │   │   │   │   'Answer':                            │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   │   │   │   │   'Source': '\n\n####                  │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │   │   │   │   │   'Github':                            │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   │   │   │   },                                       │ ││ │            │   │   │   │   'options': {                             │ ││ │            │   │   │   │   │   'allowDuplicate': False,             │ ││ │            │   │   │   │   │   'duplicateScope': 'deck',            │ ││ │            │   │   │   │   │   'duplicateScopeOptions': {           │ ││ │            │   │   │   │   │   │   'deckName': 'Default',           │ ││ │            │   │   │   │   │   │   'checkChildren': False,          │ ││ │            │   │   │   │   │   │   'checkAllModels': False          │ ││ │            │   │   │   │   │   }                                    │ ││ │            │   │   │   │   },                                       │ ││ │            │   │   │   │   'tags': ['2024年', '08月', '03日']       │ ││ │            │   │   │   },                                           │ ││ │            │   │   │   {                                            │ ││ │            │   │   │   │   'deckName': 'gpt',                       │ ││ │            │   │   │   │   'modelName': 'markdown',                 │ ││ │            │   │   │   │   'fields': {                              │ ││ │            │   │   │   │   │   'Front': 'result=await               │ ││ │            OpenGithub(self.history_note)',                          │ ││ │            │   │   │   │   │   'Back':                              │ ││ │            '异步调用OpenGithub函数，并将结果赋值给result变量。',    │ ││ │            │   │   │   │   │   'Answer':                            │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   │   │   │   │   'Source': '\n\n####                  │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │   │   │   │   │   'Github':                            │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   │   │   │   },                                       │ ││ │            │   │   │   │   'options': {                             │ ││ │            │   │   │   │   │   'allowDuplicate': False,             │ ││ │            │   │   │   │   │   'duplicateScope': 'deck',            │ ││ │            │   │   │   │   │   'duplicateScopeOptions': {           │ ││ │            │   │   │   │   │   │   'deckName': 'Default',           │ ││ │            │   │   │   │   │   │   'checkChildren': False,          │ ││ │            │   │   │   │   │   │   'checkAllModels': False          │ ││ │            │   │   │   │   │   }                                    │ ││ │            │   │   │   │   },                                       │ ││ │            │   │   │   │   'tags': ['2024年', '08月', '03日']       │ ││ │            │   │   │   },                                           │ ││ │            │   │   │   {                                            │ ││ │            │   │   │   │   'deckName': 'gpt',                       │ ││ │            │   │   │   │   'modelName': 'markdown',                 │ ││ │            │   │   │   │   'fields': {                              │ ││ │            │   │   │   │   │   'Front':                             │ ││ │            'webbrowser.open(result[0])',                            │ ││ │            │   │   │   │   │   'Back':                              │ ││ │            '使用webbrowser模块打开result列表中的第一个URL。',       │ ││ │            │   │   │   │   │   'Answer':                            │ ││ │            '___\nsource=source_reader(note_md5)[0][0]___\n![图片](… │ ││ │            │   │   │   │   │   'Source': '\n\n####                  │ ││ │            [代码](https://zh.wikipedia.org/wiki/代码)片段\n这个[代码](https://zh.wikipedia.org/wiki/代码) … │ ││ │            │   │   │   │   │   'Github':                            │ ││ │            'https://github.com/bwicarus/markdown_note/blob/main/20… │ ││ │            │   │   │   │   },                                       │ ││ │            │   │   │   │   'options': {                             │ ││ │            │   │   │   │   │   'allowDuplicate': False,             │ ││ │            │   │   │   │   │   'duplicateScope': 'deck',            │ ││ │            │   │   │   │   │   'duplicateScopeOptions': {           │ ││ │            │   │   │   │   │   │   'deckName': 'Default',           │ ││ │            │   │   │   │   │   │   'checkChildren': False,          │ ││ │            │   │   │   │   │   │   'checkAllModels': False          │ ││ │            │   │   │   │   │   }                                    │ ││ │            │   │   │   │   },                                       │ ││ │            │   │   │   │   'tags': ['2024年', '08月', '03日']       │ ││ │            │   │   │   }                                            │ ││ │            │   │   ]                                                │ ││ │            │   }                                                    │ ││ │            }                                                        │ ││ │ response = []                                                       │ ││ │     time = '20240803210023'                                         │ ││ │      url = 'http://localhost:8765'                                  │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ px\_client.py:1892 in post                                              ││                                                                         ││   1889 │   │                                                            ││   1890 │   │   **Parameters**: See `httpx.request`.                     ││   1891 │   │   """                                                      ││ ❱ 1892 │   │   return await self.request(                               ││   1893 │   │   │   "POST",                                              ││   1894 │   │   │   url,                                                 ││   1895 │   │   │   content=content,                                     ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │             auth = <httpx._client.UseClientDefault object at        │ ││ │                    0x0000024E85356750>                              │ ││ │          content = None                                             │ ││ │          cookies = None                                             │ ││ │             data = '{"action": "addNotes", "version": 6, "params":  │ ││ │                    {"notes": [{"deckName": "gpt", "m'+9970          │ ││ │       extensions = None                                             │ ││ │            files = None                                             │ ││ │ follow_redirects = <httpx._client.UseClientDefault object at        │ ││ │                    0x0000024E85356750>                              │ ││ │          headers = {'Content-Type': 'application/json'}             │ ││ │             json = None                                             │ ││ │           params = None                                             │ ││ │             self = <httpx.AsyncClient object at 0x0000024E86B67B00> │ ││ │          timeout = <httpx._client.UseClientDefault object at        │ ││ │                    0x0000024E85356750>                              │ ││ │              url = 'http://localhost:8765'                          │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ px\_client.py:1574 in request                                           ││                                                                         ││   1571 │   │   │   timeout=timeout,                                     ││   1572 │   │   │   extensions=extensions,                               ││   1573 │   │   )                                                        ││ ❱ 1574 │   │   return await self.send(request, auth=auth, follow_redire ││   1575 │                                                                ││   1576 │   @asynccontextmanager                                         ││   1577 │   async def stream(                                            ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │             auth = <httpx._client.UseClientDefault object at        │ ││ │                    0x0000024E85356750>                              │ ││ │          content = None                                             │ ││ │          cookies = None                                             │ ││ │             data = '{"action": "addNotes", "version": 6, "params":  │ ││ │                    {"notes": [{"deckName": "gpt", "m'+9970          │ ││ │       extensions = None                                             │ ││ │            files = None                                             │ ││ │ follow_redirects = <httpx._client.UseClientDefault object at        │ ││ │                    0x0000024E85356750>                              │ ││ │          headers = {'Content-Type': 'application/json'}             │ ││ │             json = None                                             │ ││ │           method = 'POST'                                           │ ││ │           params = None                                             │ ││ │          request = <Request('POST', 'http://localhost:8765')>       │ ││ │             self = <httpx.AsyncClient object at 0x0000024E86B67B00> │ ││ │          timeout = <httpx._client.UseClientDefault object at        │ ││ │                    0x0000024E85356750>                              │ ││ │              url = 'http://localhost:8765'                          │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ px\_client.py:1661 in send                                              ││                                                                         ││   1658 │   │                                                            ││   1659 │   │   auth = self._build_request_auth(request, auth)           ││   1660 │   │                                                            ││ ❱ 1661 │   │   response = await self._send_handling_auth(               ││   1662 │   │   │   request,                                             ││   1663 │   │   │   auth=auth,                                           ││   1664 │   │   │   follow_redirects=follow_redirects,                   ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │             auth = <httpx.Auth object at 0x0000024E868C4A70>        │ ││ │ follow_redirects = False                                            │ ││ │          request = <Request('POST', 'http://localhost:8765')>       │ ││ │             self = <httpx.AsyncClient object at 0x0000024E86B67B00> │ ││ │           stream = False                                            │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ px\_client.py:1689 in _send_handling_auth                               ││                                                                         ││   1686 │   │   │   request = await auth_flow.__anext__()                ││   1687 │   │   │                                                        ││   1688 │   │   │   while True:                                          ││ ❱ 1689 │   │   │   │   response = await self._send_handling_redirects(  ││   1690 │   │   │   │   │   request,                                     ││   1691 │   │   │   │   │   follow_redirects=follow_redirects,           ││   1692 │   │   │   │   │   history=history,                             ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │             auth = <httpx.Auth object at 0x0000024E868C4A70>        │ ││ │        auth_flow = <async_generator object Auth.async_auth_flow at  │ ││ │                    0x0000024E86846500>                              │ ││ │ follow_redirects = False                                            │ ││ │          history = []                                               │ ││ │          request = <Request('POST', 'http://localhost:8765')>       │ ││ │             self = <httpx.AsyncClient object at 0x0000024E86B67B00> │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ px\_client.py:1726 in _send_handling_redirects                          ││                                                                         ││   1723 │   │   │   for hook in self._event_hooks["request"]:            ││   1724 │   │   │   │   await hook(request)                              ││   1725 │   │   │                                                        ││ ❱ 1726 │   │   │   response = await self._send_single_request(request)  ││   1727 │   │   │   try:                                                 ││   1728 │   │   │   │   for hook in self._event_hooks["response"]:       ││   1729 │   │   │   │   │   await hook(response)                         ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │ follow_redirects = False                                            │ ││ │          history = []                                               │ ││ │          request = <Request('POST', 'http://localhost:8765')>       │ ││ │             self = <httpx.AsyncClient object at 0x0000024E86B67B00> │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ px\_client.py:1763 in _send_single_request                              ││                                                                         ││   1760 │   │   │   )                                                    ││   1761 │   │                                                            ││   1762 │   │   with request_context(request=request):                   ││ ❱ 1763 │   │   │   response = await transport.handle_async_request(requ ││   1764 │   │                                                            ││   1765 │   │   assert isinstance(response.stream, AsyncByteStream)      ││   1766 │   │   response.request = request                               ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │   request = <Request('POST', 'http://localhost:8765')>              │ ││ │      self = <httpx.AsyncClient object at 0x0000024E86B67B00>        │ ││ │     timer = <httpx._utils.Timer object at 0x0000024E868C5B80>       │ ││ │ transport = <httpx.AsyncHTTPTransport object at 0x0000024E868C4BC0> │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ px\_transports\default.py:372 in handle_async_request                   ││                                                                         ││   369 │   │   │   content=request.stream,                               ││   370 │   │   │   extensions=request.extensions,                        ││   371 │   │   )                                                         ││ ❱ 372 │   │   with map_httpcore_exceptions():                           ││   373 │   │   │   resp = await self._pool.handle_async_request(req)     ││   374 │   │                                                             ││   375 │   │   assert isinstance(resp.stream, typing.AsyncIterable)      ││                                                                         ││ ╭───────────────────────────── locals ──────────────────────────────╮   ││ │     req = <Request [b'POST']>                                     │   ││ │ request = <Request('POST', 'http://localhost:8765')>              │   ││ │    self = <httpx.AsyncHTTPTransport object at 0x0000024E868C4BC0> │   ││ ╰───────────────────────────────────────────────────────────────────╯   ││                                                                         ││ C:\Program                                                              ││ Files\WindowsApps\PythonSoftwareFoundation.Python.3.12_3.12.1264.0_x64_ ││ _qbz5n2kfra8p0\Lib\contextlib.py:158 in __exit__                        ││                                                                         ││   155 │   │   │   │   # tell if we get the same exception back          ││   156 │   │   │   │   value = typ()                                     ││   157 │   │   │   try:                                                  ││ ❱ 158 │   │   │   │   self.gen.throw(value)                             ││   159 │   │   │   except StopIteration as exc:                          ││   160 │   │   │   │   # Suppress StopIteration *unless* it's the same e ││   161 │   │   │   │   # was passed to throw().  This prevents a StopIte ││                                                                         ││ ╭────────────────────────────── locals ───────────────────────────────╮ ││ │      self = <contextlib._GeneratorContextManager object at          │ ││ │             0x0000024E868C4770>                                     │ ││ │ traceback = <traceback object at 0x0000024E87C8E300>                │ ││ │       typ = <class 'httpcore.ConnectError'>                         │ ││ │     value = ConnectError(OSError('All connection attempts failed')) │ ││ ╰─────────────────────────────────────────────────────────────────────╯ ││                                                                         ││ C:\Users\setsu\AppData\Local\Packages\PythonSoftwareFoundation.Python.3 ││ .12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\htt ││ px\_transports\default.py:86 in map_httpcore_exceptions                 ││                                                                         ││    83 │   │   │   raise                                                 ││    84 │   │                                                             ││    85 │   │   message = str(exc)                                        ││ ❱  86 │   │   raise mapped_exc(message) from exc                        ││    87                                                                   ││    88                                                                   ││    89 HTTPCORE_EXC_MAP = {                                              ││                                                                         ││ ╭────────────────────── locals ───────────────────────╮                 ││ │   from_exc = <class 'httpcore.RemoteProtocolError'> │                 ││ │ mapped_exc = <class 'httpx.ConnectError'>           │                 ││ │    message = 'All connection attempts failed'       │                 ││ │     to_exc = <class 'httpx.RemoteProtocolError'>    │                 ││ ╰─────────────────────────────────────────────────────╯                 │╰─────────────────────────────────────────────────────────────────────────╯ConnectError: All connection attempts failed
___
## 
### HTTP请求错误排查
- 

#### [HTTP请求](https://zh.wikipedia.org/wiki/HTTP请求)错误排查

在处理[HTTP请求](https://zh.wikipedia.org/wiki/HTTP请求)时，遇到了[连接错误](https://zh.wikipedia.org/wiki/连接错误)，具体错误信息为"All connection attempts failed"。以下是一些可能的原因和解决方案：

1. **[服务器](https://zh.wikipedia.org/wiki/服务器)未启动**：
   - 确保目标[服务器](https://zh.wikipedia.org/wiki/服务器)正在运行，并且可以通过[浏览器](https://zh.wikipedia.org/wiki/浏览器)或其他工具访问。

2. **[网络](https://zh.wikipedia.org/wiki/网络)问题**：
   - 检查本地[网络](https://zh.wikipedia.org/wiki/网络)连接，确保没有[防火墙](https://zh.wikipedia.org/wiki/防火墙)或[代理](https://zh.wikipedia.org/wiki/代理)阻止[请求](https://zh.wikipedia.org/wiki/请求)。

3. **[URL](https://zh.wikipedia.org/wiki/URL)错误**：
   - 确认[URL](https://zh.wikipedia.org/wiki/URL)正确无误，特别是[端口号](https://zh.wikipedia.org/wiki/端口号)和[协议](https://zh.wikipedia.org/wiki/协议)（如http或https）。

4. **[超时设置](https://zh.wikipedia.org/wiki/超时设置)**：
   - 检查[超时设置](https://zh.wikipedia.org/wiki/超时设置)，确保其足够长以应对[网络延迟](https://zh.wikipedia.org/wiki/网络延迟)。

5. **[依赖库](https://zh.wikipedia.org/wiki/依赖库)问题**：
   - 确保使用的[依赖库](https://zh.wikipedia.org/wiki/依赖库)（如httpx和httpcore）是最新版本。

#### [代码](https://zh.wikipedia.org/wiki/代码)示例

```python
import httpx

async def make_request():
    try:
        async with httpx.AsyncClient() as client:
            response = await client.post("http://localhost:8765", json={"key": "value"})
            response.raise_for_status()
            return response.json()
    except httpx.ConnectError as e:
        print(f"Connection error: {e}")
    except httpx.HTTPStatusError as e:
        print(f"HTTP error: {e.response.status_code}")
    except Exception as e:
        print(f"Unexpected error: {e}")

# 调用函数
import asyncio
asyncio.run(make_request())
```

#### [调试](https://zh.wikipedia.org/wiki/调试)步骤

1. **[日志记录](https://zh.wikipedia.org/wiki/日志记录)**：
   - 增加[日志记录](https://zh.wikipedia.org/wiki/日志记录)，记录[请求](https://zh.wikipedia.org/wiki/请求)和[响应](https://zh.wikipedia.org/wiki/响应)的详细信息。

2. **[网络工具](https://zh.wikipedia.org/wiki/网络工具)**：
   - 使用[网络工具](https://zh.wikipedia.org/wiki/网络工具)（如curl或Postman）手动测试[请求](https://zh.wikipedia.org/wiki/请求)。

3. **[依赖库](https://zh.wikipedia.org/wiki/依赖库)更新**：
   - 更新httpx和httpcore到最新版本。

4. **[环境变量](https://zh.wikipedia.org/wiki/环境变量)**：
   - 检查并设置相关的[环境变量](https://zh.wikipedia.org/wiki/环境变量)，如[代理](https://zh.wikipedia.org/wiki/代理)设置。

希望这些信息能帮助你解决[HTTP请求](https://zh.wikipedia.org/wiki/HTTP请求)中的[连接错误](https://zh.wikipedia.org/wiki/连接错误)问题！
___
